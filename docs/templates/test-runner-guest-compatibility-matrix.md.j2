{% raw %}{#
    A Jinja2 template for rendering runner vs guest compatibility matrix in tmt's own docs (Markdown version).
#}

<!--
   Please, do not edit this file, it is rendered from runner-guest-compatibility.yaml
   and test-runner-guest-compatibility-matrix.md.j2, and all your changes would be overwritten.
-->

## Guest Compatibility

| Runner / Guest | {% for runner in MATRIX.keys() %}**{{ runner }}** |{% endfor %}
|----------------|{% for runner in MATRIX.keys() %}:---:|{% endfor %}
{% for runner, guests in MATRIX.items() %}
| {{ runner }} | {% for state, note in guests %}{% if state == 'supported' %}✅{% elif state == 'supported-with-caveats' %}❗{% if note %} See [{{note.title}}](#note-{{ note.title | urlencode }}){% endif %}{% elif state == 'unknown' %}❓{% elif state == 'unsupported' %}❌{% endif %} |{% endfor %}
{% endfor %}

{% for note in NOTES %}
### {{ note.title }} {#note-{{ note.title | urlencode }}}

{% set processed_text = note.text | dedent %}
{# Attempt to replace known :ref: links. This is brittle and ideally done with a custom filter or regex. #}
{% set processed_text = processed_text | replace(':ref:`prepare/ansible</plugins/prepare/ansible>`', '[prepare/ansible](../../plugins/prepare/ansible.md)') %}
{% set processed_text = processed_text | replace(':ref:`prepare/feature</plugins/prepare/feature>`', '[prepare/feature](../../plugins/prepare/feature.md)') %}
{% set processed_text = processed_text | replace(':ref:`finish/ansible</plugins/finish/ansible>`', '[finish/ansible](../../plugins/finish/ansible.md)') %}
{% set processed_text = processed_text | replace(':ref:`beakerlib</spec/tests/framework>`', '[beakerlib](../../spec/tests.md#framework)') %}
{{ processed_text }}

{% endfor %}{% endraw %}
